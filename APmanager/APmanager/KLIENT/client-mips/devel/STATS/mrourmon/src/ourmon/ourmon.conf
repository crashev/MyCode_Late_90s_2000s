fixed_ipproto
fixed_tcp3	119	80
fixed_iprange1  131.252.0.0  255.255.0.0 131.252.0.0 255.255.0.0 cecs oit
fixed_cast  127.0.0.0 255.0.0.0
fixed_size
topn_ip  9
topn_port 40
topn_syn 60
topn_syn_wormfile /tmp
topn_syn_homeip 131.252.0.0 255.255.0.0
trigger_worm 100 300000 /usr/dumps
topn_icmperror 20
topn_scans 9
topn_port_scans 9
#
bpf "bpf-OUS" "UO" "ip and net 128.223.0.0/16"
bpf-next "OSU" "ip and net 128.193.0.0/16"
bpf-next "OREX" "ip and net 207.98.0.0/17"
bpf-noxtra
bpf "bpf-inout" "in" "not multicast and dst net 131.252.0.0/16 and not src net 131.252.0.0/16"
bpf-next "out" "not multicast and src net 131.252.0.0/16 and not dst net 131.252.0.0/16"
bpf-noxtra
#
bpf "ports" "ssh" "tcp port 22"
bpf-next "p2p" "port 1214 or port 6881 or port 4662 or port 6346 or port 6257 or port 6699 or port 6257"
bpf-next "web" "tcp port 80 or tcp port 443"
bpf-next "ftp" "tcp port 20 or tcp port 21"
bpf-next "email" "tcp port 25"
bpf-noxtra
#
bpf "p2pvsworld" "kazaaetc" "port 1214"
# bittorrent: 6881:6889
bpf-next "bittorrent" "tcp and (port 6881 or port 6882 or port 6883 or port 6884 or port 6885 or port 6886 or port 6887 or port 6888 or port 6889)"
# edonkey 4661, 4662, 4665, tcp for all 3, udp for the last
bpf-next "edonkey" "(udp and port 4665) or (tcp and (port 4665 or port 4661 or port 4662))"
bpf-next "gnutella" "port 6346 or port 6347"
bpf-next "winmx" "(tcp and port 6699) or (udp and port 6257)"
bpf-noxtra

# subnets of interest #1 
# 1st one has "xtra" 
bpf "bpf-subnets" "resnet" "net 131.252.204.0/22 or net 131.252.242.0/23 or net 131.252.244.0/23 or net 131.252.241.0/24"
bpf-next "distLearn" "ip and net 131.252.228.0/22"
bpf-next "oitcore" "ip and net 131.252.120.0/22"
bpf-next "CECS" "ip and net 131.252.208.0/20"
bpf-next "smith" "ip and net 131.252.76.0/24"

# subnets of interest #2
# no extra
bpf "bpf-subnets2" "library" "ip and net 131.252.180.0/24"
bpf-next "urbanCenter" "ip and net 131.252.80.0/22"
bpf-next "businessEd" "ip and net 131.252.148.0/22"
bpf-next "cramerAcad" "ip and net 131.252.168.0/22"
bpf-next "net188" "ip and net 131.252.188.0/22"
bpf-noxtra

# subnets of interest #3
# no extra
bpf "bpf-subnets3" "neubAdmin" "ip and net 131.252.196.0/22"
bpf-next "neubAcad" "ip and net 131.252.176.0/22"
bpf-next "cramerAdmin" "ip and net 131.252.168.0/22"
bpf-next "cramerAcad" "ip and net 131.252.192.0/22"
bpf-next "sb12" "ip and net 131.252.124.0/22"
bpf-noxtra

# subnets of interest #4 CECS
# no extra
bpf "CECS1" "subnet208" "ip and net 131.252.208.0/24"
bpf-next "subnet209" "ip and net 131.252.209.0/24"
bpf-next "subnet210" "ip and net 131.252.210.0/24"
bpf-next "subnet211" "ip and net 131.252.211.0/24"
bpf-noxtra

# subnets of interest #5 CECS
# no extra
bpf "CECS2" "subnet212" "ip and net 131.252.212.0/24"
bpf-next "subnet213" "ip and net 131.252.213.0/24"
bpf-next "subnet214" "ip and net 131.252.214.0/24"
bpf-next "subnet215" "ip and net 131.252.215.0/24"
bpf-noxtra

# subnets of interest #6 CECS
# no extra
bpf "CECS3" "subnet216" "ip and net 131.252.216.0/24"
bpf-next "subnet217" "ip and net 131.252.217.0/24"
bpf-next "subnet218" "ip and net 131.252.218.0/24"
bpf-next "subnet219" "ip and net 131.252.219.0/24"
bpf-noxtra

# subnets of interest #7 CECS
# no extra
bpf "CECS4" "subnet220" "ip and net 131.252.220.0/24"
bpf-next "subnet221" "ip and net 131.252.221.0/24"
bpf-next "subnet222" "ip and net 131.252.222.0/24"
bpf-next "subnet223" "ip and net 131.252.223.0/24"
bpf-noxtra

# wireless subnets
bpf "wireless" "net200" "ip and net 131.252.200.0/22"
bpf-next "net225" "ip and net 131.252.225.0/24"
bpf-next "net226" "ip and net 131.252.226.0/26"
bpf-noxtra

# vpn/tunnel graphs
bpf "vpntuns" "esp" "ip proto 50"
bpf-next "ah" "ip proto 51"
bpf-next "ipip" "ip proto 4 or ip proto 94"
bpf-next "CiscoGRE" "ip proto 47"
bpf-noxtra

# net errors
#bpf-packets
#bpf "errors" "tcprst" "tcp[tcpflags] & tcp-rst != 0"
#bpf-next "icmpunreach" "icmp[icmptype] == icmp-unreach"
#bpf-next "icmpping" "(icmp[icmptype] == icmp-echoreply) || (icmp[icmptype] == icmp-echo)"
#bpf-next "icmptimxceed" "icmp[icmptype] == icmp-timxceed"
#bpf-noxtra
#bpf-bytes

# tcp control 
#bpf-packets
#bpf "tcpcontrol" "rst" "tcp[tcpflags] & tcp-rst != 0"
#bpf-next  "syn" "tcp[tcpflags] & tcp-syn != 0"
#bpf-next "fin" "tcp[tcpflags] & tcp-fin != 0"
#bpf-noxtra
#bpf-bytes

#0 - net unreachable
#1 - host unreachable
#3 - port unreachable
#12 - admin prohibited
# icmp port unreachables
bpf-packets
bpf "icmpunreach" "net" "icmp[icmptype] == icmp-unreach && icmp[icmpcode] == 0"
bpf-next "host" "icmp[icmptype] == icmp-unreach && icmp[icmpcode] == 1"
bpf-next "port" "icmp[icmptype] == icmp-unreach && icmp[icmpcode] == 3"
bpf-next "adminprohibit" "icmp[icmptype] == icmp-unreach && icmp[icmpcode] == 13"
bpf-noxtra
bpf-bytes

bpf-packets
bpf "protopkts" "all" ""
bpf-next "tcp" "tcp"
bpf-next "udp" "udp"
bpf-next "icmp" "icmp"
bpf-bytes
